<div class="page-wrapper">
  <div class="main-container">

    <!-- MAIN GRID -->
    <div class="content-grid">

      <!-- ================= LEFT SECTION ================= -->
      <div class="left-section">

        <!-- CARD 1 : DETAIL DU DIAGNOSTIC -->
        <div class="diagnostic-main-card">

          <div class="card-header">
            <h2 class="diagnostic-title">Détail du diagnostic</h2>
          </div>

          <!-- Plant Image -->
          <div class="plant-image-container">
            <img [src]="plantImageUrl" alt="Plant diagnostique" class="plant-image">
          </div>

          <!-- Diagnostic Result -->
           <div class="diagnostic-result">
            <div class="diagnostic-info">
              <h3 class="disease-name">{{ diagnosticType }}</h3>
               <p class="plant-culture">Culture: {{ plantCulture }}</p>
                <p class="diagnostic-date">{{ diagnosticDate | date:'dd MMMM yyyy - HH:mm' }}</p>
            </div>

            <div class="diagnostic-score">
              <span class="score-value" [ngClass]="getScoreClass()">
                {{ diagnosticScore }}%
              </span>
              <span class="status-badge" [ngClass]="{'confirmed': isConfirmed}">
                Confirmé
              </span>
            </div>
          </div>
          



          <!-- ACTION BUTTONS -->
          <div class="diagnostic-actions">
            <button class="btn-validate" (click)="validateDiagnostic()">
              <span class="btn-icon">✔</span>
              Valider
            </button>

            <button class="btn-correct" (click)="correctDiagnostic()">
              <span class="btn-icon">✏</span>
              Corriger
            </button>
          </div>

        </div>

        <!-- CARD 2 : POURQUOI CETTE DECISION -->
        <div class="reasons-card">
          <h4 class="section-heading">Pourquoi cette décision ?</h4>

          <div class="reasons-list">
            <div class="reason-item" *ngFor="let reason of reasons">
              <span class="reason-icon">{{ reason.icon }}</span>
              <p class="reason-text">{{ reason.text }}</p>
            </div>
          </div>
        </div>

      </div>


      <!-- ================= RIGHT SECTION ================= -->
      <div class="right-section">



        <!-- ====== SENSOR DATA ====== -->
        <div class="sensors-container">
          <h4 class="subsection-title">Données capteurs</h4>

          <div class="sensor-cards">
            <div class="sensor-card" *ngFor="let sensor of sensorData">

              <div class="sensor-card-header">
                <div class="sensor-info">
                  <span class="sensor-icon-large">
                    {{ sensor.icon }}
                  </span>
                  <span class="sensor-name">
                    {{ sensor.name }}
                  </span>
                </div>
              </div>

              <div class="chart-wrapper">
                <svg class="sensor-chart" viewBox="0 0 100 100" preserveAspectRatio="none">

                  <line x1="0" y1="25" x2="100" y2="25" class="grid-line"/>
                  <line x1="0" y1="50" x2="100" y2="50" class="grid-line"/>
                  <line x1="0" y1="75" x2="100" y2="75" class="grid-line"/>

                  <polygon
                    [attr.points]="getChartArea(sensor.data)"
                    [attr.fill]="sensor.color"
                    class="chart-fill"
                  />

                  <polyline
                    [attr.points]="getChartPoints(sensor.data)"
                    [attr.stroke]="sensor.color"
                    class="chart-line"
                  />
                </svg>

                <div class="time-labels">
                  <span *ngFor="let label of getDisplayLabels()" class="time-label">
                    {{ label }}
                  </span>
                </div>
              </div>

            </div>
          </div>
        </div>


        <!-- ====== RECOMMENDATIONS ====== -->
        <div class="recommendations-container">
          <h4 class="subsection-title">Recommandations</h4>

          <div class="recommendations-box">
            <ol class="recommendations-list">
              <li class="recommendation-item"
                  *ngFor="let rec of recommendations">
                {{ rec }}
              </li>
            </ol>

            <button class="save-btn"
                    (click)="saveRecommendations()">
              Enregistrer les recommandations
            </button>
          </div>
        </div>

      </div>

    </div>
  </div>
</div>
